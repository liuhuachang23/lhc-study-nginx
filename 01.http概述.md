# http

##### http请求/响应交互模型

1. 浏览器分析超链接中的URL，并开始查找应用缓存
2. 浏览器向DNS请求解析域名的IP
3. DNS将解析出的IP返回到浏览器
4. 浏览器（随机端口）与服务器建立TCP（80端口）链接，TCP三次握手
5. 客户端发起http请求，浏览器请求web页面（index.html）
6. 服务器给出响应内容，将web页面发送给浏览器
7. 客户端向服务端发起TCP断开，四次挥手释放TCP连接

```diff
- 向一个网站发起查询操作时，网站需要通过数据库查询，而数据库查询则需要对应的参数，浏览器中的url地址通常在?后面是参数，以&作为分隔符隔离不同的参数
+ DNS查询：客户端向服务端发起查询->递归查询，服务端向服务端发起查询->迭代查询
```

##### http请求方法

| get  | 获取，下载          |
| ---- | ------------------- |
| post | 上传                |
| put  | 请求存储一个web页面 |

##### http响应状态码

| 200  |          访问成功          |
| :--: | :------------------------: |
| 301  |          永久跳转          |
| 302  |          临时跳转          |
| 304  |          本地缓存          |
| 307  |          内部跳转          |
| 400  |         客户端错误         |
| 401  |          认证错误          |
| 403  |    找不到主页/权限不足     |
| 404  |        找不到该页面        |
| 500  | 内部错误（连接数据库问题） |
| 502  |       找不到后端主机       |
| 503  |         服务器过载         |
| 504  |            超时            |

#### http补充知识

| 字段       | 意义                                                         |
| ---------- | ------------------------------------------------------------ |
| User-Agent | 用户客户端应用（用户使用的浏览器）                           |
| Referer    | 浏览器给服务器的请求报文表明自身是从哪个网页/URL获得当前请求的网址/URL |
| Location   | 服务器给浏览器的回应报文中的下一重定向地址                   |
| cookie     | 服务器发送到浏览器并保存到本地的一小块数据，它会在浏览器向同一服务器再发起请求时被携带并发送到服务器上 |

http是无状态协议，各个页面之间没有联系，且http不会记录用户的任何信息，而在某些情况下访问不同的站点需要对用户进行识别时，需要通过cookie保存用户的一些信息，比如电商网站的购物车，不同的站点进行购物则需要通过cookie记录购物信息

cookie主要用于三个方面：

- 会话状态管理（如用户登陆状态、购物车、游戏分数或其他需要记录的信息）
- 个性化设置（如用户自定义设置、主题等）
- 浏览器行为追踪（如追踪分析用户行为等）

> cookie会话共享：后端服务器集群共享cookie记录文件

#### http总结

- **http请求**
  - 请求的方法：GET、POST
  - 请求的协议：http://
  - 请求的域名：www.baidu.com
  - 请求的端口：80、443
  - 请求的文件：/index.html
  - 请求的参数：类型、压缩、缓存、长连接
  - 请求的空行

- **http响应**
  - 响应协议
  - 响应状态码
  - 响应服务器使用的软件版本
  - 响应空行
  - 响应内容主体

> http1.0：短连接机制，一次连接，一次请求，一次响应
>
> http1.1：长连接机制，一次连接，多次串行请求与响应
>
> http2.0：一次连接，并行批量执行请求与响应

- **pv**：页面浏览量，打开一个页面时发起了多少个请求也就是产生了多少pv

- **uv**：独立设备，通过一台电脑打开一个页面，电脑就是一个uv

- **ip**：独立IP，多个设备使用nat技术通过一个ip上网

- **SOA**：松耦合架构，将应用程序的不同功能单元拆分，通过这些服务之间定义良好的接口联系起来